var baseJs={firstClick:!0,cId:"",fireShowId:"",init:function(){var e=this;e.protocol=window.location.protocol,e.showId=e._getQueryString("si"),e.containerID=e._getQueryString("containerID"),e.cId=e.containerID,e.ua=e.isWeiXin(),window.addEventListener("message",function(t){if(e.containerID!=t.data.containerID)return!1;if("ADDataReady"==t.data.action&&(window.newAwards=t.data.data,window.clickPlugin=t.data.clickPlugin,window.gameData=t.data.pluginData,window.backupData=t.data.backupData,e.game=t.data.game,e.setGameData()),"doOnce"==t.data.action&&(e.fireShowId=t.data.si,window.newAwards=t.data.data,window.clickPlugin=t.data.clickPlugin,window.gameData=t.data.pluginData,window.backupData=t.data.backupData,e.game=t.data.game,e.setGameData()),"askOpenDialog"==t.data.action&&window.parent.postMessage({action:"openMyAward",containerID:e.containerID,list:JSON.parse(window.localStorage.getItem("myAward"))},"*"),"lotteryCallback"==t.data.action){var a={curl:t.data.curl,desc:t.data.desc,dj_btntext:t.data.dj_btntext,img:t.data.img,award:t.data.data.dj_rpamount};window.newAwards.ads||(window.newAwards.ads=[]),window.newAwards.ads.unshift(a)}}),e.getInfos(),e.openAward(),e.openRule()},_getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(t);return null!=a?unescape(a[2]):null},_getDeviceInfo:function(){return navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?2:1},_ajax:function(e,t,a,n,i){return $.ajax({url:e,data:t||{},type:a||"POST",async:n||!0,success:i,error:function(e){console.log("line 114 Error")}})},_setRem:function(){var e=document.documentElement,t="orientationchange"in window?"orientationchange":"resize",a=function(){var t=e.clientWidth||375;(t=t>750?750:t)&&(e.style.fontSize=t/375*20+"px",window.remscale=t/375)};document.addEventListener&&(window.addEventListener(t,a,!1),document.addEventListener("DOMContentLoaded",a,!1))},isWeiXin:function(){return"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)?1:0},getLoaded:function(e){var t,a=this,n=a.dateTime(new Date,"date");if(!a.showId)return!1;try{localStorage.getItem("DZPMinDateTime"+a.showId)?(t=localStorage.getItem("DZPMinDateTime"+a.showId),n!=t&&(localStorage.removeItem("enterFirst"),localStorage.setItem("DZPMinDateTime"+a.showId,n))):localStorage.setItem("DZPMinDateTime"+a.showId,n)}catch(e){a.getCookie("DZPMinDateTime"+a.showId)?(t=a.getCookie("DZPMinDateTime"+a.showId),n!=dateTime&&(localStorage.removeItem("enterFirst"),a.setCookie("DZPMinDateTime"+a.showId,n))):a.setCookie("DZPMinDateTime"+a.showId,n)}},setCookie:function(e,t){var a=new Date;a.setTime(a.getTime()+2592e6),document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()},getCookie:function(e){var t,a=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(a))?unescape(t[2]):null},delCookie:function(e){var t=this,a=new Date;a.setTime(a.getTime()-1);var n=t.getCookie(e);null!=n&&(document.cookie=e+"="+n+";expires="+a.toGMTString())},dateTime:function(e,t){var a=this,n=e;if(e){var i=new Date(e),o=i.getFullYear()+"-"+a.addZero(i.getMonth()+1)+"-"+a.addZero(i.getDate()),r=a.addZero(i.getHours())+":"+a.addZero(i.getMinutes())+":"+a.addZero(i.getSeconds());n="date"===t?o:"time"===t?r:o+" "+r}return n},addZero:function(e){return e<10?"0"+e:e},askData:function(){window.parent.postMessage({action:"askADData",containerID:this.containerID,si:this.showId},"*")},openDialog:function(e){window.parent.postMessage({action:"openDialog",data:e,containerID:this.containerID,si:this.showId},"*")},getInfos:function(){var e=0,t=this,a=window.setInterval(function(){if(e++,window.newAwards){for(var n in newAwards.ads)newAwards.ads[n].impurl=newAwards.impurl,newAwards.ads[n].imptk.push(newAwards.impurl+newAwards.ads[n].imparg);window.clearInterval(a),"fire"===window.backupData[0].isFire&&$(".start").trigger("click")}e>3&&!window.newAwards&&(t.askData(),e=0)},100)},adShowPV:function(e){var t=(e.imptk,this);$.each(e.imptk,function(e,a){t.sendLog(a)})},adclick:function(e,t,a){var n=this,i=e.clktk.join(",");i=i.replace("__EVENT_TIME_START__",t).replace("__EVENT_TIME_END__",a),$.each(i.split(","),function(e,t){n.sendLog(t)})},adClickPlugin:function(e,t,a){var n=this,i=window.clickPlugin;if(!window.clickPlugin)return!1;i=i.replace("__EVENT_TIME_START__",e).replace("__EVENT_TIME_END__",t).replace("__ACT_NUM__",a),$.each(i.split(","),function(e,t){n.sendLog(t)})},getUID:function(){function e(e){var t,a=1,n=0;if(e)for(a=0,t=e.length-1;t>=0;t--)n=e.charCodeAt(t),a=(a<<6&268435455)+n+(n<<14),n=266338304&a,a=0!=n?a^n>>21:a;return a}return(""+e(document.referrer)+(new Date).getTime()+e(document.cookie)).substr(0,32)},stringify:function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a+"="+encodeURIComponent(e[a]));return t.join("&")},sendLog:function(e){window.parent.postMessage({action:"sendLog",url:e,containerID:this.containerID,si:this.showId},"*")},syncRemains:function(e){window.parent.postMessage({action:"syncRemains",containerID:this.containerID,times:e},"*")},setGameData:function(){var e=JSON.parse(window.gameData.dj_interaction),t=e.skin.styleUrl?e.skin.styleUrl:"//cjhd.mediav.com/css/wheel/wheel_default.css",a=e.template.jsUrl?e.template.jsUrl:"//cjhd.mediav.com/js/wheel/wheel_default.js";$("head").append('<link rel="stylesheet" href="'+t+'" type="text/css"/>'),$.getScript(a,function(){}),$(".page-group").fadeIn(1e3),$(".page-loading").fadeOut(1e3),"w7Z0D8"===this.fireShowId&&$(".start").trigger("click")},openRule:function(){var e=this;$(".ruleIcon").on("click",function(){window.parent.postMessage({action:"openRule",containerID:e.containerID},"*")})},openAward:function(){var e=this;$("#myAwards").on("click",function(){window.parent.postMessage({action:"openMyAward",containerID:e.containerID,list:JSON.parse(window.localStorage.getItem("myAward"))},"*")})},saveAward:function(e){var t=JSON.parse(window.localStorage.getItem("myAward"))||[],a=!1;if(t.length>0)for(var n=0;n<t.length;n++){t[n].desc==e.desc&&(a=!0);var i=(new Date).getTime();i-t[n].expireDate>=6048e5&&t.splice(n,1)}if(!a){if(e.award)return;e.expireDate=(new Date).getTime(),t.push(e),window.localStorage.setItem("myAward",JSON.stringify(t))}},callDrawLottery:function(){window.parent.postMessage({action:"drawLottery",containerID:this.containerID},"*")}};baseJs.init();